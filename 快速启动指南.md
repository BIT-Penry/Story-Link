# ⚡ MovieHub 快速启动指南

## 🚀 一键启动 (推荐)

### macOS / Linux

```bash
# 1. 首次安装依赖
./setup.sh

# 2. 启动项目
./start.sh
```

### Windows

```bash
# 双击运行
start.bat
```

---

## 📝 手动启动

### 步骤 1: 配置环境变量

复制 `.env.example` 为 `.env`:

```bash
cp .env.example .env
```

编辑 `.env` 文件:

```env
OPENAI_API_KEY=你的_OpenAI_API_Key
GOOGLE_API_KEY=你的_Google_API_Key
```

> ⚠️ **重要**: 如果没有 API Key,项目仍可运行,但 AI 功能会使用 Mock 数据。

---

### 步骤 2: 启动后端

```bash
# 进入后端目录
cd backend

# 安装依赖 (仅首次)
pip install -r requirements.txt

# 启动服务器
python main.py
```

后端将在 `http://localhost:8000` 运行

✅ 访问 `http://localhost:8000/docs` 查看 API 文档

---

### 步骤 3: 启动前端

**在新终端中运行:**

```bash
# 进入前端目录
cd frontend

# 安装依赖 (仅首次)
npm install

# 启动开发服务器
npm run dev
```

前端将在 `http://localhost:3000` 运行

✅ 打开浏览器访问 `http://localhost:3000`

---

## 🎉 访问应用

### 主要入口

- **前端页面**: http://localhost:3000
- **后端 API**: http://localhost:8000
- **API 文档**: http://localhost:8000/docs

---

## 🧪 测试功能

### 测试流程

1. **创作故事**
   - 访问首页 → 点击"写新故事"
   - 填写表单并提交

2. **AI 润色**
   - 进入故事详情页
   - 点击"AI 润色"按钮

3. **Fork 续写**
   - 点击"Fork 并续写"
   - 创作新版本

4. **生成视频**
   - 点击"发布为视频"
   - 等待视频生成完成

---

## 🐛 常见问题

### 问题 1: 后端启动失败

**错误信息**: `ModuleNotFoundError: No module named 'fastapi'`

**解决方案**:
```bash
cd backend
pip install -r requirements.txt
```

---

### 问题 2: 前端启动失败

**错误信息**: `Cannot find module 'react'`

**解决方案**:
```bash
cd frontend
rm -rf node_modules
npm install
```

---

### 问题 3: 端口被占用

**错误信息**: `Address already in use`

**解决方案**:

```bash
# macOS / Linux - 查找并杀死进程
lsof -ti:8000 | xargs kill -9  # 后端
lsof -ti:3000 | xargs kill -9  # 前端

# 或者修改端口
# 后端: 编辑 backend/main.py 最后一行
uvicorn.run(app, host="0.0.0.0", port=8001)

# 前端: 编辑 frontend/vite.config.js
server: { port: 3001 }
```

---

### 问题 4: API Key 无效

**症状**: AI 润色失败,视频生成失败

**解决方案**:
1. 检查 `.env` 文件是否正确配置
2. 验证 API Key 是否有效
3. 查看后端日志获取详细错误信息

**临时方案**: 项目会自动使用 Mock 数据,不影响其他功能

---

### 问题 5: 视频生成超时

**原因**:
- Google Veo API 生成时间较长 (2-5 分钟)
- 网络连接问题
- API 配额不足

**解决方案**:
- 等待更长时间,系统会自动轮询
- 检查网络连接
- 查看后端日志: `tail -f backend.log`

---

## 🛠️ 开发模式

### 后端热重载

```bash
cd backend
uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

### 前端热重载

```bash
cd frontend
npm run dev
```

### 查看数据库

```bash
sqlite3 backend/storylink.db

# 查看所有故事
SELECT * FROM stories;

# 退出
.exit
```

---

## 🚢 生产部署

### 构建前端

```bash
cd frontend
npm run build
```

构建产物在 `frontend/dist/` 目录

### 运行后端

```bash
cd backend
uvicorn main:app --host 0.0.0.0 --port 8000
```

### 使用 Docker (可选)

```bash
# 构建镜像
docker build -t storylink .

# 运行容器
docker run -p 8000:8000 -p 3000:3000 storylink
```

---

## 📊 性能优化建议

1. **数据库优化**
   - 为高频查询字段添加索引
   - 使用 PostgreSQL 替代 SQLite (生产环境)

2. **前端优化**
   - 启用代码分割 (Code Splitting)
   - 使用懒加载 (Lazy Loading)
   - 压缩静态资源

3. **后端优化**
   - 使用 Redis 缓存热点数据
   - 启用 GZIP 压缩
   - 使用 CDN 加速静态文件

4. **AI 优化**
   - 批量处理请求
   - 使用流式响应
   - 缓存常见润色结果

---

## 🎯 下一步

1. ✅ 项目已启动
2. 📖 阅读 [README.md](README.md) 了解更多功能
3. 🎬 查看 [演示脚本.md](演示脚本.md) 准备演示
4. 🐛 遇到问题查看 [故障排除](#常见问题)

---

**祝开发顺利!** 🚀

如有问题,请查看项目 README 或联系团队成员。

