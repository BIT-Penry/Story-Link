# ğŸ“‹ StoryLink éœ€æ±‚å˜æ›´å®ç°æ–¹æ¡ˆ

## ğŸ¯ æ–°éœ€æ±‚æ€»ç»“

### æ ¸å¿ƒå˜æ›´

1. **æ˜µç§°ç³»ç»Ÿ**ï¼šç”¨æˆ·è¿›å…¥ç½‘ç«™æ—¶éœ€è¦è®¾ç½®æ˜µç§°ï¼ˆå­˜å‚¨åœ¨ localStorageï¼‰
2. **æ•…äº‹å³æ—¶ä¿å­˜**ï¼šåˆ›å»ºæ•…äº‹åç«‹å³ä¿å­˜ï¼Œä¸éœ€è¦ç”Ÿæˆè§†é¢‘
3. **ç»­å†™é™åˆ¶**ï¼šä½œè€…å¯ä»¥è®¾ç½®å…è®¸å¤šå°‘äººç»­å†™ï¼ˆ1-5äººï¼‰
4. **é¦–é¡µå±•ç¤º**ï¼šæ˜¾ç¤ºæ‰€æœ‰æ•…äº‹ï¼ˆåŒ…æ‹¬æœªç”Ÿæˆè§†é¢‘çš„ï¼‰
5. **è§†é¢‘ç”Ÿæˆæƒé™**ï¼šåªæœ‰æ•…äº‹ä½œè€…å¯ä»¥é€‰æ‹©æ˜¯å¦ç”Ÿæˆè§†é¢‘
6. **è§†é¢‘çŠ¶æ€ç‹¬ç«‹**ï¼šç”Ÿæˆè§†é¢‘æ˜¯å¯é€‰æ“ä½œï¼Œä¸å½±å“æ•…äº‹å±•ç¤º

---

## ğŸ—„ï¸ æ•°æ®åº“ç»“æ„å˜æ›´

### ä¿®æ”¹ stories è¡¨

```sql
-- æ·»åŠ æ–°å­—æ®µ
ALTER TABLE stories ADD COLUMN max_contributors INTEGER DEFAULT 5;
ALTER TABLE stories ADD COLUMN fork_count INTEGER DEFAULT 0;
ALTER TABLE stories ADD COLUMN is_original BOOLEAN DEFAULT TRUE;

-- å­—æ®µè¯´æ˜ï¼š
-- max_contributors: å…è®¸çš„æœ€å¤§ç»­å†™äººæ•°ï¼ˆ1-5ï¼‰
-- fork_count: å½“å‰å·²æœ‰å¤šå°‘äººç»­å†™
-- is_original: æ˜¯å¦æ˜¯åŸåˆ›æ•…äº‹ï¼ˆTRUEï¼‰è¿˜æ˜¯ç»­å†™ï¼ˆFALSEï¼‰
```

### å®Œæ•´è¡¨ç»“æ„

```sql
CREATE TABLE IF NOT EXISTS stories (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    title TEXT NOT NULL,
    author TEXT NOT NULL,
    content TEXT NOT NULL,
    parent_id INTEGER,
    is_approved BOOLEAN DEFAULT FALSE,
    video_url TEXT,
    video_status TEXT DEFAULT 'none',  -- æ”¹ä¸º 'none' è¡¨ç¤ºæœªç”Ÿæˆ
    max_contributors INTEGER DEFAULT 5,
    fork_count INTEGER DEFAULT 0,
    is_original BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (parent_id) REFERENCES stories(id)
);
```

---

## ğŸ”§ åç«¯å®ç°

### 1. æ›´æ–°æ•°æ®åº“åˆå§‹åŒ–

ä¿®æ”¹ `backend/main.py`:

```python
def init_db():
    """åˆ›å»ºæ•°æ®åº“è¡¨"""
    conn = sqlite3.connect(DB_PATH)
    cursor = conn.cursor()
    
    cursor.execute("""
        CREATE TABLE IF NOT EXISTS stories (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            title TEXT NOT NULL,
            author TEXT NOT NULL,
            content TEXT NOT NULL,
            parent_id INTEGER,
            is_approved BOOLEAN DEFAULT FALSE,
            video_url TEXT,
            video_status TEXT DEFAULT 'none',
            max_contributors INTEGER DEFAULT 5,
            fork_count INTEGER DEFAULT 0,
            is_original BOOLEAN DEFAULT TRUE,
            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
            FOREIGN KEY (parent_id) REFERENCES stories(id)
        )
    """)
    
    conn.commit()
    conn.close()
    print("âœ… æ•°æ®åº“åˆå§‹åŒ–å®Œæˆ")

def migrate_db():
    """è¿ç§»ç°æœ‰æ•°æ®åº“"""
    conn = sqlite3.connect(DB_PATH)
    cursor = conn.cursor()
    
    try:
        # æ£€æŸ¥å­—æ®µæ˜¯å¦å­˜åœ¨
        cursor.execute("PRAGMA table_info(stories)")
        columns = [col[1] for col in cursor.fetchall()]
        
        # æ·»åŠ æ–°å­—æ®µ
        if "max_contributors" not in columns:
            cursor.execute("ALTER TABLE stories ADD COLUMN max_contributors INTEGER DEFAULT 5")
        if "fork_count" not in columns:
            cursor.execute("ALTER TABLE stories ADD COLUMN fork_count INTEGER DEFAULT 0")
        if "is_original" not in columns:
            cursor.execute("ALTER TABLE stories ADD COLUMN is_original BOOLEAN DEFAULT TRUE")
        
        # æ›´æ–°ç°æœ‰æ•°æ®çš„ video_status
        cursor.execute("UPDATE stories SET video_status = 'none' WHERE video_status = 'pending'")
        
        conn.commit()
        print("âœ… æ•°æ®åº“è¿ç§»å®Œæˆ")
    except Exception as e:
        print(f"âš ï¸ æ•°æ®åº“è¿ç§»å¤±è´¥: {e}")
        conn.rollback()
    finally:
        conn.close()

# åœ¨ init_db() åè°ƒç”¨
init_db()
migrate_db()
```

### 2. æ›´æ–° Pydantic æ¨¡å‹

```python
class StoryCreate(BaseModel):
    title: str
    author: str
    content: str
    parent_id: Optional[int] = None
    max_contributors: int = 5  # æ–°å¢ï¼šå…è®¸çš„ç»­å†™äººæ•°

class StoryResponse(BaseModel):
    id: int
    title: str
    author: str
    content: str
    parent_id: Optional[int]
    is_approved: bool
    video_url: Optional[str]
    video_status: str
    max_contributors: int  # æ–°å¢
    fork_count: int  # æ–°å¢
    is_original: bool  # æ–°å¢
    created_at: str
```

### 3. ä¿®æ”¹åˆ›å»ºæ•…äº‹æ¥å£

```python
@app.post("/api/stories", response_model=StoryResponse)
def create_story(story: StoryCreate):
    """åˆ›å»ºæ–°æ•…äº‹ï¼ˆç«‹å³ä¿å­˜ï¼Œä¸éœ€è¦ç”Ÿæˆè§†é¢‘ï¼‰"""
    try:
        # éªŒè¯å‚æ•°
        if not story.title.strip():
            raise HTTPException(status_code=400, detail="æ ‡é¢˜ä¸èƒ½ä¸ºç©º")
        if not story.author.strip():
            raise HTTPException(status_code=400, detail="ä½œè€…æ˜µç§°ä¸èƒ½ä¸ºç©º")
        if not story.content.strip():
            raise HTTPException(status_code=400, detail="å†…å®¹ä¸èƒ½ä¸ºç©º")
        if story.max_contributors < 1 or story.max_contributors > 5:
            raise HTTPException(status_code=400, detail="ç»­å†™äººæ•°å¿…é¡»åœ¨1-5ä¹‹é—´")
        
        conn = get_db_connection()
        cursor = conn.cursor()
        
        # å¦‚æœæ˜¯ç»­å†™ï¼ˆæœ‰ parent_idï¼‰
        is_original = story.parent_id is None
        
        if not is_original:
            # æ£€æŸ¥çˆ¶æ•…äº‹æ˜¯å¦å­˜åœ¨
            cursor.execute("SELECT max_contributors, fork_count FROM stories WHERE id = ?", 
                         (story.parent_id,))
            parent = cursor.fetchone()
            
            if not parent:
                conn.close()
                raise HTTPException(status_code=404, detail="çˆ¶æ•…äº‹ä¸å­˜åœ¨")
            
            # æ£€æŸ¥æ˜¯å¦è¶…è¿‡ç»­å†™äººæ•°é™åˆ¶
            if parent["fork_count"] >= parent["max_contributors"]:
                conn.close()
                raise HTTPException(
                    status_code=400, 
                    detail=f"è¯¥æ•…äº‹å·²è¾¾åˆ°æœ€å¤§ç»­å†™äººæ•°é™åˆ¶ï¼ˆ{parent['max_contributors']}äººï¼‰"
                )
            
            # æ›´æ–°çˆ¶æ•…äº‹çš„ç»­å†™è®¡æ•°
            cursor.execute(
                "UPDATE stories SET fork_count = fork_count + 1 WHERE id = ?",
                (story.parent_id,)
            )
        
        # æ’å…¥æ–°æ•…äº‹
        cursor.execute(
            """
            INSERT INTO stories 
            (title, author, content, parent_id, max_contributors, is_original, video_status)
            VALUES (?, ?, ?, ?, ?, ?, 'none')
            """,
            (story.title, story.author, story.content, story.parent_id, 
             story.max_contributors, is_original)
        )
        
        conn.commit()
        story_id = cursor.lastrowid
        
        # è·å–åˆšåˆ›å»ºçš„æ•…äº‹
        cursor.execute("SELECT * FROM stories WHERE id = ?", (story_id,))
        row = cursor.fetchone()
        conn.close()
        
        print(f"âœ… æ•…äº‹åˆ›å»ºæˆåŠŸ: id={story_id}, author={story.author}, is_original={is_original}")
        
        return dict_from_row(row)
    
    except HTTPException:
        raise
    except Exception as e:
        raise HTTPException(status_code=500, detail=f"åˆ›å»ºæ•…äº‹å¤±è´¥: {str(e)}")
```

### 4. ä¿®æ”¹è·å–æ•…äº‹åˆ—è¡¨æ¥å£

```python
@app.get("/api/stories", response_model=List[StoryResponse])
def get_stories(
    filter_by: str = "all",  # all, original, fork, with_video
    sort_by: str = "created_at",  # created_at, fork_count
    limit: int = 50
):
    """
    è·å–æ•…äº‹åˆ—è¡¨
    
    filter_by:
        - all: æ‰€æœ‰æ•…äº‹
        - original: ä»…åŸåˆ›æ•…äº‹
        - fork: ä»…ç»­å†™æ•…äº‹
        - with_video: æœ‰è§†é¢‘çš„æ•…äº‹
    """
    try:
        conn = get_db_connection()
        cursor = conn.cursor()
        
        # æ„å»ºæŸ¥è¯¢æ¡ä»¶
        where_clause = ""
        if filter_by == "original":
            where_clause = "WHERE is_original = 1"
        elif filter_by == "fork":
            where_clause = "WHERE is_original = 0"
        elif filter_by == "with_video":
            where_clause = "WHERE video_status = 'completed'"
        
        # éªŒè¯æ’åºå­—æ®µ
        if sort_by not in ["created_at", "fork_count"]:
            sort_by = "created_at"
        
        query = f"""
            SELECT * FROM stories 
            {where_clause}
            ORDER BY {sort_by} DESC 
            LIMIT ?
        """
        
        cursor.execute(query, (limit,))
        rows = cursor.fetchall()
        conn.close()
        
        return [dict_from_row(row) for row in rows]
    
    except Exception as e:
        raise HTTPException(status_code=500, detail=f"è·å–æ•…äº‹åˆ—è¡¨å¤±è´¥: {str(e)}")
```

### 5. æ·»åŠ ç”Ÿæˆè§†é¢‘æ¥å£ï¼ˆä»…ä½œè€…å¯ç”¨ï¼‰

```python
class GenerateVideoRequest(BaseModel):
    author: str  # éªŒè¯ä½œè€…èº«ä»½

@app.post("/api/stories/{story_id}/generate-video")
def generate_video_for_story(
    story_id: int, 
    request: GenerateVideoRequest,
    background_tasks: BackgroundTasks
):
    """
    ä¸ºæ•…äº‹ç”Ÿæˆè§†é¢‘ï¼ˆä»…ä½œè€…å¯æ“ä½œï¼‰
    """
    try:
        conn = get_db_connection()
        cursor = conn.cursor()
        
        # è·å–æ•…äº‹ä¿¡æ¯
        cursor.execute("SELECT * FROM stories WHERE id = ?", (story_id,))
        story = cursor.fetchone()
        
        if not story:
            conn.close()
            raise HTTPException(status_code=404, detail="æ•…äº‹ä¸å­˜åœ¨")
        
        # éªŒè¯ä½œè€…èº«ä»½
        if story["author"] != request.author:
            conn.close()
            raise HTTPException(status_code=403, detail="åªæœ‰æ•…äº‹ä½œè€…å¯ä»¥ç”Ÿæˆè§†é¢‘")
        
        # æ£€æŸ¥æ˜¯å¦å·²ç»åœ¨ç”Ÿæˆä¸­
        if story["video_status"] == "generating":
            conn.close()
            raise HTTPException(status_code=400, detail="è§†é¢‘æ­£åœ¨ç”Ÿæˆä¸­ï¼Œè¯·ç¨å€™")
        
        # æ›´æ–°çŠ¶æ€ä¸ºç”Ÿæˆä¸­
        cursor.execute(
            "UPDATE stories SET video_status = 'generating' WHERE id = ?",
            (story_id,)
        )
        conn.commit()
        conn.close()
        
        # åå°ä»»åŠ¡ï¼šç”Ÿæˆè§†é¢‘
        background_tasks.add_task(generate_video_task, story_id, story["content"])
        
        return {
            "message": "è§†é¢‘ç”Ÿæˆä»»åŠ¡å·²å¯åŠ¨",
            "story_id": story_id,
            "status": "generating"
        }
    
    except HTTPException:
        raise
    except Exception as e:
        raise HTTPException(status_code=500, detail=f"ç”Ÿæˆè§†é¢‘å¤±è´¥: {str(e)}")
```

### 6. æ·»åŠ æ£€æŸ¥ç»­å†™æƒé™æ¥å£

```python
@app.get("/api/stories/{story_id}/can-fork")
def check_can_fork(story_id: int):
    """æ£€æŸ¥æ•…äº‹æ˜¯å¦è¿˜èƒ½è¢«ç»­å†™"""
    try:
        conn = get_db_connection()
        cursor = conn.cursor()
        
        cursor.execute(
            "SELECT max_contributors, fork_count FROM stories WHERE id = ?",
            (story_id,)
        )
        row = cursor.fetchone()
        conn.close()
        
        if not row:
            raise HTTPException(status_code=404, detail="æ•…äº‹ä¸å­˜åœ¨")
        
        can_fork = row["fork_count"] < row["max_contributors"]
        
        return {
            "can_fork": can_fork,
            "max_contributors": row["max_contributors"],
            "current_forks": row["fork_count"],
            "remaining": row["max_contributors"] - row["fork_count"]
        }
    
    except HTTPException:
        raise
    except Exception as e:
        raise HTTPException(status_code=500, detail=f"æ£€æŸ¥å¤±è´¥: {str(e)}")
```

---

## ğŸ¨ å‰ç«¯å®ç°

### 1. åˆ›å»ºæ˜µç§°è®¾ç½®ç»„ä»¶

åˆ›å»º `frontend/src/components/NicknameModal.jsx`:

```jsx
import { useState, useEffect } from 'react'

export default function NicknameModal({ onComplete }) {
  const [nickname, setNickname] = useState('')
  const [show, setShow] = useState(false)

  useEffect(() => {
    // æ£€æŸ¥æ˜¯å¦å·²è®¾ç½®æ˜µç§°
    const savedNickname = localStorage.getItem('user_nickname')
    if (!savedNickname) {
      setShow(true)
    } else {
      onComplete(savedNickname)
    }
  }, [])

  const handleSubmit = (e) => {
    e.preventDefault()
    
    if (!nickname.trim()) {
      alert('è¯·è¾“å…¥æ˜µç§°')
      return
    }
    
    if (nickname.length > 20) {
      alert('æ˜µç§°ä¸èƒ½è¶…è¿‡20ä¸ªå­—ç¬¦')
      return
    }
    
    // ä¿å­˜æ˜µç§°åˆ° localStorage
    localStorage.setItem('user_nickname', nickname.trim())
    setShow(false)
    onComplete(nickname.trim())
  }

  const handleChangeNickname = () => {
    const newNickname = prompt('è¯·è¾“å…¥æ–°æ˜µç§°:', nickname)
    if (newNickname && newNickname.trim()) {
      setNickname(newNickname.trim())
      localStorage.setItem('user_nickname', newNickname.trim())
    }
  }

  if (!show) return null

  return (
    <div className="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4">
      <div className="bg-white rounded-2xl p-8 max-w-md w-full shadow-2xl">
        <h2 className="text-3xl font-bold text-gray-800 mb-4 text-center">
          ğŸ‘‹ æ¬¢è¿æ¥åˆ° StoryLink
        </h2>
        
        <p className="text-gray-600 mb-6 text-center">
          è¯·è®¾ç½®æ‚¨çš„æ˜µç§°ä»¥å¼€å§‹åˆ›ä½œ
        </p>
        
        <form onSubmit={handleSubmit}>
          <input
            type="text"
            value={nickname}
            onChange={(e) => setNickname(e.target.value)}
            placeholder="è¾“å…¥æ‚¨çš„æ˜µç§°"
            className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-purple-500 focus:outline-none text-lg mb-4"
            maxLength={20}
            autoFocus
          />
          
          <button
            type="submit"
            className="w-full px-6 py-3 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-lg font-bold text-lg hover:shadow-lg transition-all"
          >
            å¼€å§‹åˆ›ä½œ
          </button>
        </form>
        
        <p className="text-sm text-gray-500 mt-4 text-center">
          æ˜µç§°ä¼šä¿å­˜åœ¨æœ¬åœ°ï¼Œæ‚¨éšæ—¶å¯ä»¥æ›´æ”¹
        </p>
      </div>
    </div>
  )
}
```

### 2. æ›´æ–°é¦–é¡µ

ä¿®æ”¹ `frontend/src/pages/HomePage.jsx`:

```jsx
import { useState, useEffect } from 'react'
import { Link } from 'react-router-dom'
import { getAllStories } from '../api/api'  // æ”¹ç”¨è·å–æ‰€æœ‰æ•…äº‹
import NicknameModal from '../components/NicknameModal'

function HomePage() {
  const [stories, setStories] = useState([])
  const [loading, setLoading] = useState(true)
  const [userNickname, setUserNickname] = useState('')
  const [filterBy, setFilterBy] = useState('all')  // all, original, fork, with_video

  useEffect(() => {
    const nickname = localStorage.getItem('user_nickname')
    if (nickname) {
      setUserNickname(nickname)
      loadStories()
    }
  }, [filterBy])

  const loadStories = async () => {
    try {
      setLoading(true)
      const response = await fetch(`/api/stories?filter_by=${filterBy}&limit=50`)
      const data = await response.json()
      setStories(data)
    } catch (err) {
      console.error('åŠ è½½æ•…äº‹å¤±è´¥:', err)
    } finally {
      setLoading(false)
    }
  }

  const handleNicknameComplete = (nickname) => {
    setUserNickname(nickname)
    loadStories()
  }

  const changeNickname = () => {
    const newNickname = prompt('è¯·è¾“å…¥æ–°æ˜µç§°:', userNickname)
    if (newNickname && newNickname.trim()) {
      localStorage.setItem('user_nickname', newNickname.trim())
      setUserNickname(newNickname.trim())
    }
  }

  return (
    <div className="min-h-screen py-8 px-4">
      {/* æ˜µç§°è®¾ç½®å¼¹çª— */}
      <NicknameModal onComplete={handleNicknameComplete} />

      <div className="max-w-6xl mx-auto">
        {/* å¤´éƒ¨ */}
        <header className="text-center mb-12">
          <div className="flex justify-between items-center mb-4">
            <div className="flex-1"></div>
            <h1 className="text-6xl font-bold text-white flex-1">
              ğŸ¬ StoryLink
            </h1>
            <div className="flex-1 text-right">
              {userNickname && (
                <button
                  onClick={changeNickname}
                  className="text-white/80 hover:text-white text-sm underline"
                >
                  ğŸ‘¤ {userNickname}
                </button>
              )}
            </div>
          </div>
          
          <p className="text-xl text-white/80 mb-8">
            æ¬¢è¿æ¥åˆ°å½±è§†åˆ›ä½œç‰ˆ Githubï¼Œæºæ‰‹å…±åˆ›ä¸‹ä¸€ä¸ªç»å…¸
          </p>
          
          <Link
            to="/edit"
            className="inline-flex items-center px-8 py-4 bg-white text-purple-600 rounded-full font-bold text-lg hover:bg-purple-50 transition-all transform hover:scale-105 shadow-lg"
          >
            <span className="text-2xl mr-2">âœ¨</span>
            å†™æ–°æ•…äº‹
          </Link>
        </header>

        {/* ç­›é€‰æ  */}
        <div className="flex gap-4 mb-6 justify-center flex-wrap">
          {[
            { value: 'all', label: 'å…¨éƒ¨æ•…äº‹' },
            { value: 'original', label: 'åŸåˆ›æ•…äº‹' },
            { value: 'fork', label: 'ç»­å†™æ•…äº‹' },
            { value: 'with_video', label: 'æœ‰è§†é¢‘çš„æ•…äº‹' }
          ].map(filter => (
            <button
              key={filter.value}
              onClick={() => setFilterBy(filter.value)}
              className={`px-6 py-2 rounded-full font-medium transition-all ${
                filterBy === filter.value
                  ? 'bg-white text-purple-600'
                  : 'bg-white/20 text-white hover:bg-white/30'
              }`}
            >
              {filter.label}
            </button>
          ))}
        </div>

        {/* æ•…äº‹åˆ—è¡¨ */}
        <div className="space-y-6">
          {loading && (
            <div className="text-center py-12">
              <div className="inline-block animate-spin rounded-full h-12 w-12 border-4 border-white border-t-transparent"></div>
              <p className="text-white mt-4">åŠ è½½ä¸­...</p>
            </div>
          )}

          {!loading && stories.length === 0 && (
            <div className="bg-white/10 backdrop-blur-md rounded-2xl p-12 text-center text-white">
              <p className="text-xl mb-4">è¿˜æ²¡æœ‰æ•…äº‹</p>
              <p className="text-white/60">æˆä¸ºç¬¬ä¸€ä¸ªåˆ›ä½œè€…å§!</p>
            </div>
          )}

          {!loading && stories.length > 0 && (
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
              {stories.map((story) => (
                <div
                  key={story.id}
                  className="bg-white/10 backdrop-blur-md rounded-2xl p-6 hover:bg-white/20 transition-all transform hover:scale-105 border border-white/20"
                >
                  {/* æ ‡ç­¾ */}
                  <div className="flex gap-2 mb-3">
                    {story.is_original ? (
                      <span className="px-2 py-1 bg-blue-500/80 text-white text-xs rounded-full">
                        åŸåˆ›
                      </span>
                    ) : (
                      <span className="px-2 py-1 bg-green-500/80 text-white text-xs rounded-full">
                        ç»­å†™
                      </span>
                    )}
                    
                    {story.video_status === 'completed' && (
                      <span className="px-2 py-1 bg-pink-500/80 text-white text-xs rounded-full">
                        ğŸ¥ æœ‰è§†é¢‘
                      </span>
                    )}
                  </div>

                  <h3 className="text-xl font-bold text-white mb-2 line-clamp-2">
                    {story.title}
                  </h3>
                  
                  <p className="text-white/60 text-sm mb-2">
                    ğŸ‘¤ {story.author}
                  </p>

                  {story.is_original && (
                    <p className="text-white/60 text-xs mb-4">
                      ğŸ”€ {story.fork_count}/{story.max_contributors} äººç»­å†™
                    </p>
                  )}

                  <p className="text-white/80 text-sm mb-4 line-clamp-3">
                    {story.content}
                  </p>

                  <div className="flex gap-2">
                    <Link
                      to={`/story/${story.id}`}
                      className="flex-1 text-center px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors font-medium"
                    >
                      æŸ¥çœ‹è¯¦æƒ…
                    </Link>
                    
                    {story.video_status === 'completed' && story.video_url && (
                      <Link
                        to={`/story/${story.id}`}
                        className="px-4 py-2 bg-pink-500 text-white rounded-lg hover:bg-pink-600 transition-colors font-medium"
                      >
                        â–¶ï¸
                      </Link>
                    )}
                  </div>
                </div>
              ))}
            </div>
          )}
        </div>
      </div>
    </div>
  )
}

export default HomePage
```

### 3. æ›´æ–°ç¼–è¾‘é¡µ

ä¿®æ”¹ `frontend/src/pages/EditPage.jsx`ï¼Œæ·»åŠ ç»­å†™äººæ•°è®¾ç½®ï¼š

```jsx
// åœ¨è¡¨å•ä¸­æ·»åŠ ç»­å†™äººæ•°é€‰æ‹©
<div className="mb-6">
  <label className="block text-white text-sm font-bold mb-2">
    å…è®¸å¤šå°‘äººç»­å†™ï¼Ÿï¼ˆ1-5äººï¼‰
  </label>
  <select
    value={maxContributors}
    onChange={(e) => setMaxContributors(Number(e.target.value))}
    className="w-full px-4 py-3 bg-white/90 border-2 border-white rounded-lg focus:outline-none focus:border-purple-400"
  >
    {[1, 2, 3, 4, 5].map(num => (
      <option key={num} value={num}>{num} äºº</option>
    ))}
  </select>
</div>
```

### 4. æ›´æ–°æ•…äº‹è¯¦æƒ…é¡µ

æ·»åŠ ç”Ÿæˆè§†é¢‘æŒ‰é’®ï¼ˆä»…ä½œè€…å¯è§ï¼‰ï¼š

```jsx
// åœ¨è¯¦æƒ…é¡µæ·»åŠ 
{story.author === userNickname && (
  <div className="mb-6">
    {story.video_status === 'none' && (
      <button
        onClick={handleGenerateVideo}
        className="px-6 py-3 bg-gradient-to-r from-pink-500 to-red-500 text-white rounded-lg font-bold hover:shadow-lg transition-all"
      >
        ğŸ¬ ç”Ÿæˆè§†é¢‘
      </button>
    )}
    
    {story.video_status === 'generating' && (
      <div className="px-6 py-3 bg-yellow-500/50 text-white rounded-lg font-bold">
        â³ è§†é¢‘ç”Ÿæˆä¸­...
      </div>
    )}
    
    {story.video_status === 'completed' && (
      <button
        onClick={handleRegenerateVideo}
        className="px-6 py-3 bg-purple-500 text-white rounded-lg font-bold hover:bg-purple-600 transition-all"
      >
        ğŸ”„ é‡æ–°ç”Ÿæˆè§†é¢‘
      </button>
    )}
  </div>
)}
```

---

## ğŸ“ å®æ–½æ­¥éª¤

### æ­¥éª¤ 1: å¤‡ä»½æ•°æ®åº“

```bash
cd /Applications/å®‹æ™—æ/é»‘å®¢æ¾/ä¸­å…³æ‘_22ç»„_hub/Story-Link/backend
cp storylink.db storylink.db.backup
```

### æ­¥éª¤ 2: æ›´æ–°åç«¯

```bash
# 1. ä¿®æ”¹ backend/main.pyï¼ˆå‚è€ƒä¸Šé¢çš„ä»£ç ï¼‰
# 2. é‡å¯åç«¯æœåŠ¡
python main.py
```

### æ­¥éª¤ 3: æ›´æ–°å‰ç«¯

```bash
# 1. åˆ›å»º NicknameModal ç»„ä»¶
# 2. ä¿®æ”¹ HomePage.jsx
# 3. ä¿®æ”¹ EditPage.jsx
# 4. ä¿®æ”¹ StoryDetailPage.jsx
# 5. é‡å¯å‰ç«¯
npm run dev
```

### æ­¥éª¤ 4: æµ‹è¯•æµç¨‹

1. æ‰“å¼€ç½‘ç«™ï¼Œè®¾ç½®æ˜µç§°
2. åˆ›å»ºæ–°æ•…äº‹ï¼Œè®¾ç½®ç»­å†™äººæ•°
3. æ•…äº‹ç«‹å³æ˜¾ç¤ºåœ¨é¦–é¡µ
4. å…¶ä»–ç”¨æˆ·å¯ä»¥ç»­å†™
5. ä½œè€…å¯ä»¥éšæ—¶é€‰æ‹©ç”Ÿæˆè§†é¢‘

---

è¿™ä¸ªæ–¹æ¡ˆå®Œå…¨æ»¡è¶³ä½ çš„éœ€æ±‚ï¼éœ€è¦æˆ‘å¸®ä½ å¼€å§‹å®æ–½å—ï¼Ÿ

